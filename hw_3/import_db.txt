# SCRIPT 1:
LOAD CSV WITH HEADERS from 'file:///continents.csv' as row1
MERGE (cont:Continent {id:row1.id, name:row1.name})
WITH cont
LOAD CSV WITH HEADERS from 'file:///subcontinents.csv' as row2
MATCH (cont:Continent {id: row2.continent_id})
MERGE (sub:Subcontinent {id: row2.id, name: row2.name})
MERGE (sub)-[:BELONGS_TO_CONTINENT]->(cont);

# SCRIPT 2:
LOAD CSV WITH HEADERS from 'file:///countries.csv' as row3
MATCH (cont:Continent {id: row3.continent_id})
MERGE (c:Country {
    id: row3.id, 
    name: row3.name, 
    iso3: row3.iso3, 
    phone_code: row3.phone_code, 
    capital: COALESCE(row3.capital, ''),
    currency_name: row3.currency_name, 
    nationality: row3.nationality, 
    latitude: row3.latitude, 
    longitude: row3.longitude
})
MERGE (c)-[:BELONGS_TO_CONTINENT]->(cont);

# SCRIPT 3:
LOAD CSV WITH HEADERS from 'file:///countries.csv' as row3
MATCH (sub:Subcontinent {id: row3.subcontinent_id})
MERGE (c:Country {
    id: row3.id, 
    name: row3.name, 
    iso3: row3.iso3, 
    phone_code: row3.phone_code, 
    capital: COALESCE(row3.capital, ''),
    currency_name: row3.currency_name, 
    nationality: row3.nationality, 
    latitude: row3.latitude, 
    longitude: row3.longitude
})
MERGE (c)-[:BELONGS_TO_SUBCONTINENT]->(sub);